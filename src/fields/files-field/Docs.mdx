import { Meta, Markdown, Stories } from "@storybook/blocks";
import * as FilesFieldStories from "./filesField.stories";

import Config from "./config.md?raw";

<Meta title="fields/filesField" of={FilesFieldStories} />

# `filesField(): ZodField<File[] | [File, ...File[]]>`

A field to hold `input[type="file"]` values.

> **NOTE:** Can hold any number of files, be it zero, one or many.

```ts
import { filesField } from "@form-atoms/field";

// required file, must be filled to submit
const profilePic = filesField({
  required_error: "Please upload you profile picture.",
});

// optional files, can be empty to submit
const attachments = filesField().optional();
```

## Initial Config

<Markdown>{Config}</Markdown>

> **NOTE:** the `File` API is not available on the server side, so in practice the schema is defined as `z.array(isServer ? z.never() : z.instanceof(File)`.

## useFilesFieldProps(filesField)

A hook providing props to control a file input.

```tsx
const FileInput = ({
  field,
  label,
}: {
  field: FilesFieldAtom;
  label: ReactNode;
}) => {
  // the `value` is the FileList which cannot be passed to the input element, so we drop it
  const { value, ...props } = useFilesFieldProps(field);

  return (
    <div style={{ margin: "20px 0" }}>
      <FieldLabel field={field} label={label} />
      <input type="file" {...props} />
      <div>
        <FieldErrors field={field} />
      </div>
    </div>
  );
};
```

<Stories />
