import { Meta, Markdown, Stories } from "@storybook/blocks";
import * as FileFieldStories from "./fileField.stories";

import Config from "./config.md?raw";

<Meta title="fields/fileField" of={FileFieldStories} />

# `fileField(): ZodField<ZodArray<ZodType<File>> | undefined>`

A field to hold `input[type="file"]` values.

> **NOTE:** Can hold any number of files, be it zero, one or many.

```ts
import { fileField } from "@form-atoms/field";

// required file, must be filled to submit
const profilePic = fileField({
  required_error: "Please upload you profile picture.",
});

// optional files, can be empty to submit
const attachments = fileField({ optional: true });
```

## Initial Config

<Markdown>{Config}</Markdown>

> **NOTE:** the `File` API is not available on the server side, so in practice the schema is defined as `z.array(isServer ? z.undefined() : z.instanceof(File)`.

## useFileFieldProps(fileField)

A hook providing props to control a file input.

```tsx
const FileInput = ({
  field,
  label,
}: {
  field: FileFieldAtom;
  label: ReactNode;
}) => {
  // the `value` is the FileList which cannot be passed to the input element, so we drop it
  const { value, ...props } = useFileFieldProps(field);

  return (
    <div style={{ margin: "20px 0" }}>
      <FieldLabel field={field} label={label} />
      <input type="file" {...props} />
      <div>
        <FieldErrors field={field} />
      </div>
    </div>
  );
};
```

<Stories />
